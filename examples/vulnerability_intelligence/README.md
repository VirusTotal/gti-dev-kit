# Google Threat Intelligence (GTI) Vulnerability Intelligence Script

This repository contains a Python script designed to interface with the Google Threat Intelligence (GTI) API to retrieve curated vulnerability data, including CVE identifiers, risk ratings, and executive summaries. The script enables security teams, threat researchers, and developers to stay informed about critical vulnerabilities, prioritize patching efforts, and link vulnerabilities to threat actor activity, exploitation trends, and related malware campaigns.

## Overview

The `vulnerability.py` script retrieval and processing of vulnerability intelligence from the GTI API, providing detailed summaries to assist in security operations. It supports proactive threat management by surfacing key data points, such as exploitation status and mitigation options, and includes robust error handling for reliable data ingestion. The script is designed to integrate with security platforms, enabling clickable CVE links and cross-referencing with organizational assets for risk-based prioritization.


## Vulnerability Intelligence
  - **Objective**: Provide context on vulnerabilities (CVEs) by linking them to threat actor activity, exploitation trends, and related malware campaigns.

  - **Key Implementation Points**:
      - Allow users to query GTI by CVE-ID to retrieve associated intelligence reports, threat actors, and Indicators of Compromise (IOCs).
      - Surface key data points, such as whether a vulnerability is actively exploited in the wild and which malware or threat actors are leveraging it.
      - Cross-reference vulnerability data with an organization’s asset information to help prioritize patching based on real-world risk.

  - **Relevant API Calls**:
      - `/collections?filter=collection_type:vulnerability`: Fetches curated vulnerability collections from the GTI API.

  - **User Experience (UX) Best Practice**:
      - When a CVE is mentioned in your platform, make it a clickable link that opens a detailed summary of the GTI vulnerability intelligence, enhancing usability for analysts.

  - **Configuration Tip**:
      - Configure the script to filter vulnerabilities by risk rating or exploitation status to focus on high-priority issues. Allow administrators to set query intervals to balance API quota and data freshness.

  - [**Best Practices Guide**](https://docs.google.com/document/d/1foYWa5FnlwtYBIo63YIZU5AOInI7UsNdrn9g0ty25Ag/edit?resourcekey=0-SIeMz9ALACxg0qGd75Jm4g&tab=t.0#heading=h.pyf55u6v8ozf)

## Key Features
  - **Vulnerability Retrieval**: Fetches curated vulnerability collections from the GTI API, including CVE IDs, risk ratings, and executive summaries.

  - **Error Handling**: Implements robust error detection and retry logic for API and network issues, with clear feedback and retry suggestions.

  - **Data Display**: Summarizes key vulnerability details (e.g., CVE ID, risk rating, exploitation status) in a concise, human-readable format.

  - **Cross-Referencing Support**: Enables integration with asset inventories to prioritize patching based on organizational risk exposure.

  - **Multi-Collection Support**: Allows querying of other GTI collection types (e.g., threat-actor, malware-family) using similar API calls for broader threat intelligence.


## Scripts Overview
The repository includes the following script, tailored to retrieve and display vulnerability intelligence from the GTI API.

#### `vulnerability.py`
  - **Purpose**: Fetches and displays curated vulnerability data from the GTI API, providing CVE IDs, risk ratings, and executive summaries for security prioritization.

  - **Key Features**:
      - **Vulnerability Retrieval**: Fetches curated vulnerability collections from the GTI API.
      - **Error Handling**: Handles API and network errors gracefully with retry suggestions.
      - **Data Display**: Summarizes and displays key vulnerability details for quick visibility.

  - **API Endpoints Used**:
      - `/collections?filter=collection_type:vulnerability`: Fetches vulnerability collections.

  - **Use Case**: Enabling security teams to stay informed about critical vulnerabilities, prioritize patching, and link CVEs to threat actor activity and malware campaigns.


## How to Run the Script
Follow these steps to set up and run the script:

### 1.  Install Dependencies
Ensure you have the required Python libraries installed. Run the following command in your terminal or command prompt:

```bash
pip install -r requirements.txt
```

### 2.  Configure API Credentials
The script requires a valid GTI API key and product header. Replace the placeholders in `vulnerability.py`:

```python
GTI_API_KEY = "YOUR_API_KEY"
X_TOOL_HEADER = "YOUR_PRODUCT_NAME"
```

### 3.  Run the Script
Execute the script using Python from the command line. Navigate to the `vulnerability_intelligence` directory and run:

```bash
python vulnerability.py
```

### 4.  Customize Inputs
Modify the script to adjust query parameters (e.g., `filter` in `get_vulnerability()`) to target specific vulnerabilities or other collection types. Refer to inline comments for guidance on parameters and formats.

### 5.  Review Output
The script generates a concise report of recent vulnerabilities, including CVE IDs, risk ratings, and summaries. Example outputs are available in the `/vulnerability_intelligence` directory. For instance, the output of the `vulnerability.py` script can be found in the `vulnerability_output.md` file.

## Collection Types
The following table lists the collection types supported by the GTI API’s `/collections` endpoint, which can be queried using the `collection_type` filter (e.g., `collection_type:vulnerability`). These types enable retrieval of various threat intelligence objects, such as IOCs, threat actors, and malware families.

| Collection Type | Identifier | Description |
| :--- | :--- | :--- |
| IOC Collection | `collection` | Collections of Indicators of Compromise (IOCs) grouped by malicious campaigns or malware families, sourced from OSINT, users, trusted partners, or Google TI experts. | 
| Threat Actor | `threat-actor` | Curated information on threat actors, tracked by Google TI experts or trusted partners. | 
| Malware Family | `malware-family` | Curated information on malware families, provided by Google TI experts or trusted partners. | 
| Software Toolkit | `software-toolkit` | Curated information on malicious software or toolkits used in threat campaigns, provided by Google TI experts. | 
| Campaign | `campaign` | Curated information on threat campaigns, provided by Google TI experts. | 
| Report | `report` | OSINT and curated threat reports from the cybersecurity community, trusted partners, or Google TI experts. | 
| Vulnerability | `vulnerability` | Curated information on vulnerabilities and exploitations, analyzed by Google TI experts. | 


## Additional Notes
  - **Query Customization**: Adjust the `filter` parameter in `vulnerability.py` to query specific vulnerabilities or other collection types (e.g., `collection_type:threat-actor`). See the "**Collection Types**" section for supported types.

  - **API Quota Management**: The script includes retry logic for HTTP 429 (rate limit) and 5xx errors. Monitor API usage to stay within your quota, especially for frequent queries.

  - **Error Handling**: The script handles network failures, invalid responses, and parsing errors, providing clear feedback and retry suggestions. Check console output for error details.

  - **Output Storage**: By default, outputs are printed to the console. Modify `vulnerability.py` to save vulnerability data to a file for integration with security platforms (e.g., SIEM).

  - **Script Documentation**: The `vulnerability.py` script contains detailed comments explaining its functionality, parameters, and error handling.

  - **GTI API Documentation**: For endpoint details and query syntax, refer to the official [GTI Documentation](https://gtidocs.virustotal.com/reference/list-vulnerabilities).

  - **Troubleshooting**: Create a `docs/troubleshooting.md` file for common issues like API errors, rate limits, or invalid filters, or refer to console output for error details.


